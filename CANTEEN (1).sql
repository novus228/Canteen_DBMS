

CREATE TABLE CANTEEN(
CAN_ID INT(11) PRIMARY KEY,
NAME VARCHAR(30) NOT NULL,
LOCATION VARCHAR(30) NOT NULL,
NO_OF_SEATS INT(11),
MGR_ID INT(11)
);

CREATE TABLE EMPLOYEE(
EMP_ID INT(11) PRIMARY KEY,
FNAME VARCHAR(30) NOT NULL,
MINIT VARCHAR(30),
LNAME VARCHAR(30),
GENDER CHAR(1) NOT NULL,
POSITION VARCHAR(20) NOT NULL,
SALARY INT(11) ,
CAN_ID INT(11) REFERENCES CANTEEN(CAN_ID)
);

alter table canteen add foreign key(MGR_ID) references EMPLOYEE(EMP_ID);

CREATE TABLE FOOD(
FOOD_ID INT(11) PRIMARY KEY,
FOOD_NAME VARCHAR(30) NOT NULL,
TYPE CHAR(3) NOT NULL,
CAN_ID INT(11) REFERENCES CANTEEN(CAN_ID),
FOOD_PRICE Int(11)
);

CREATE TABLE CUSTOMER(
CUST_ID INT(11) PRIMARY KEY,
CUST_NAME VARCHAR(30) NOT NULL,
NO_OF_PEOPLE INT(11) NOT NULL
);

/* ASSUMING THAT ORDER IS A WEAK ENITY*/
CREATE TABLE ORDER_FOOD(
ORDER_ID INT(11) PRIMARY KEY,
CUST_ID INT(11) REFERENCES CUSTOMER(CUST_ID),
TOTAL INT(11),
EMP_ID INT(11) REFERENCES EMPLOYEE(EMP_ID)

);

CREATE TABLE COOK(
FOOD_ID INT(11) REFERENCES FOOD(FOOD_ID),
EMP_ID INT(11) REFERENCES EMPLOYEE(EMP_ID),
PRIMARY KEY(FOOD_ID,EMP_ID)
);

alter table ORDER_FOOD modify ORDER_ID int(11) AUTO_INCREMENT, AUTO_INCREMENT=1;


INSERT INTO CANTEEN VALUES(1,'OVEN FRESH','NITTE',80,NULL);
INSERT INTO CANTEEN VALUES(2,'OVEN FRESH','BANGLORE',100,NULL);


INSERT INTO EMPLOYEE VALUES(100,'RAMESH','S','RAO','M','MANAGER',20000,1);
INSERT INTO EMPLOYEE VALUES(101,'SEEMA',NULL,'SURESH','F','MANAGER',20000,2);
INSERT INTO EMPLOYEE VALUES(102,'MOHIT','L','SHETTY','M','HEAD CHEF',15001,1);
INSERT INTO EMPLOYEE VALUES(103,'VENKATESH','D','NAYAK','M','HEAD CHEF',16000,2);
INSERT INTO EMPLOYEE VALUES(104,'SUREKHA',NULL,'KISHAN','F','ASSISTANT CHEF',8000,1);
INSERT INTO EMPLOYEE VALUES(105,'RAVI','H','TEJ','M','ASSISTANT CHEF',9000,2);
INSERT INTO EMPLOYEE VALUES(106,'KAVYA','S','DZOZA','F','WAITER',5500,1);
INSERT INTO EMPLOYEE VALUES(107,'MAYA','M','VARMA','F','WAITER',5642,2);
INSERT INTO EMPLOYEE VALUES(108,'SOMU',NULL,'SHETTY','M','CLEANER',3100,1);
INSERT INTO EMPLOYEE VALUES(109,'RAMITHA','V','MOHAN','F','CLEANER',3242,2);

UPDATE CANTEEN
SET MGR_ID=100
WHERE CAN_ID=1;

UPDATE CANTEEN
SET MGR_ID=101
WHERE CAN_ID=2;

INSERT INTO FOOD VALUES(200,'PLAIN DOSA','VEG',1,25);
INSERT INTO FOOD VALUES(201,'MASALA DOSA','VEG',1,35);
INSERT INTO FOOD VALUES(202,'PANI PURI','VEG',1,30);
INSERT INTO FOOD VALUES(203,'SANDWICH','VEG',1,20);
INSERT INTO FOOD VALUES(204,'PAV BHAJI','VEG',1,40);
INSERT INTO FOOD VALUES(205,'SAMOSA','VEG',1,10);
INSERT INTO FOOD VALUES(206,'CHICKEN CURRY','NON',1,65);
INSERT INTO FOOD VALUES(207,'FISH CURRY','NON',1,65);
INSERT INTO FOOD VALUES(208,'PANNER CURRY','VEG',1,65);
INSERT INTO FOOD VALUES(209,'ROTI','VEG',1,10);
INSERT INTO FOOD VALUES(210,'STHALI1','VEG',1,50);
INSERT INTO FOOD VALUES(211,'NTHALI2','VEG',1,60);
INSERT INTO FOOD VALUES(212,'COFEE','VEG',1,15);
INSERT INTO FOOD VALUES(213,'TEA','VEG',1,15);
INSERT INTO FOOD VALUES(214,'JUICE','VEG',1,20);
INSERT INTO FOOD VALUES(215,'ICECREAM','VEG',1,10);

INSERT INTO FOOD VALUES(300,'PLAIN DOSA','VEG',2,25);
INSERT INTO FOOD VALUES(301,'MYSORE MASALA DOSA','VEG',2,35);
INSERT INTO FOOD VALUES(302,'VADA PAV','VEG',2,15);
INSERT INTO FOOD VALUES(303,'NTHALI1','VEG',2,50);
INSERT INTO FOOD VALUES(304,'STHALI2','VEG',2,50);
INSERT INTO FOOD VALUES(305,'NOODLES','VEG',2,45);
INSERT INTO FOOD VALUES(306,'CHICKEN TIKKA CURRY','NON',2,70);
INSERT INTO FOOD VALUES(307,'FISH CURRY','NON',2,65);
INSERT INTO FOOD VALUES(308,'BABYCORN CURRY','VEG',2,60);
INSERT INTO FOOD VALUES(309,'PANNER TIKKA CURRY','VEG',2,60);
INSERT INTO FOOD VALUES(310,'CHIKEN SANDWICH','NON',2,30);
INSERT INTO FOOD VALUES(311,'VSANDWICH','VEG',2,25);
INSERT INTO FOOD VALUES(312,'ROTI','VEG',2,10);
INSERT INTO FOOD VALUES(313,'SAMOSA','VEG',2,11);
INSERT INTO FOOD VALUES(314,'PUFF','VEG',2,20);
INSERT INTO FOOD VALUES(315,'TEA','VEG',2,10);
INSERT INTO FOOD VALUES(316,'COFEE','VEG',2,12);
INSERT INTO FOOD VALUES(317,'JUICE','VEG',2,18);
INSERT INTO FOOD VALUES(318,'ICECREAM','VEG',2,15);


INSERT INTO CUSTOMER VALUES(1000,'TULASI',4);
INSERT INTO CUSTOMER VALUES(1001,'TANISHA',2);
INSERT INTO CUSTOMER VALUES(1002,'SPARSHA',6);
INSERT INTO CUSTOMER VALUES(1003,'SIDDHI',1);
INSERT INTO CUSTOMER VALUES(1004,'TANMAY',7);
INSERT INTO CUSTOMER VALUES(1005,'SASHANTH',3);
INSERT INTO CUSTOMER VALUES(1006,'VEENAL',4);
INSERT INTO CUSTOMER VALUES(1007,'SHREYAS',2);


INSERT INTO ORDER_FOOD VALUES(2000,1000,100,100);
INSERT INTO ORDER_FOOD VALUES(2001,1002,60,100);
INSERT INTO ORDER_FOOD VALUES(2003,1003,250,101);
INSERT INTO ORDER_FOOD VALUES(2004,1004,300,100);
INSERT INTO ORDER_FOOD VALUES(2005,1005,30,101);


INSERT INTO COOK VALUES(200,102);
INSERT INTO COOK VALUES(201,102);
INSERT INTO COOK VALUES(202,102);
INSERT INTO COOK VALUES(203,102);
INSERT INTO COOK VALUES(204,102);
INSERT INTO COOK VALUES(205,102);
INSERT INTO COOK VALUES(206,102);
INSERT INTO COOK VALUES(206,104);
INSERT INTO COOK VALUES(207,104);
INSERT INTO COOK VALUES(208,104);
INSERT INTO COOK VALUES(209,104);
INSERT INTO COOK VALUES(210,104);
INSERT INTO COOK VALUES(211,104);
INSERT INTO COOK VALUES(212,104);
INSERT INTO COOK VALUES(213,104);
INSERT INTO COOK VALUES(214,104);
INSERT INTO COOK VALUES(215,102);
INSERT INTO COOK VALUES(209,102);
INSERT INTO COOK VALUES(208,102);

INSERT INTO COOK VALUES(300,103);
INSERT INTO COOK VALUES(301,103);
INSERT INTO COOK VALUES(302,103);
INSERT INTO COOK VALUES(303,103);
INSERT INTO COOK VALUES(304,103);
INSERT INTO COOK VALUES(305,103);
INSERT INTO COOK VALUES(306,103);
INSERT INTO COOK VALUES(306,105);
INSERT INTO COOK VALUES(307,105);
INSERT INTO COOK VALUES(308,105);
INSERT INTO COOK VALUES(309,105);
INSERT INTO COOK VALUES(310,105);
INSERT INTO COOK VALUES(311,105);
INSERT INTO COOK VALUES(312,105);
INSERT INTO COOK VALUES(313,105);
INSERT INTO COOK VALUES(314,105);
INSERT INTO COOK VALUES(315,103);
INSERT INTO COOK VALUES(309,103);
INSERT INTO COOK VALUES(308,103);
INSERT INTO COOK VALUES(316,105);
INSERT INTO COOK VALUES(317,105);
INSERT INTO COOK VALUES(318,103);

create view v1 as
(
select count(ORDER_ID) AS COUNT1,EMP_ID 
FROM ORDER_FOOD
GROUP BY EMP_ID
)



delimiter //
create procedure test1(in a int(11),out b int(11))
begin
	select count1 INTO b from v1 WHERE EMP_ID=a;
end//
delimiter ;


create event test_event
on schedule every 2 minute
starts CURRENT_TIMESTAMP
ENDS CURRENT_TIMESTAMP + INTERVAL 365 DAY
DO
	UPDATE EMPLOYEE
	set SALARY=SALARY+10


